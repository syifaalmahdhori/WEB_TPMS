<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Grafik & Hasil – TPMS Fuzzy Sugeno</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    body { background:#0b1220; color:#e9edf3; }

    /* ===== SIDEBAR ===== */
    :root {
      --sidebar-w: 256px;
      --sidebar-bg: #0e1626;
      --sidebar-border: #1f2b46;
      --sidebar-link: #c7d2e5;
      --sidebar-link-active-bg: #16233b;
      --sidebar-link-active: #ffffff;
    }
    .topbar {
      position: sticky; top: 0; z-index: 1050;
      background: #0b1220; border-bottom: 1px solid #1f2b46;
    }
    .content-wrap { transition: margin-left .25s ease; }
    .sidebar {
      position: fixed; inset: 0 auto 0 0; width: var(--sidebar-w);
      background: var(--sidebar-bg); border-right: 1px solid var(--sidebar-border);
      transform: translateX(-100%);
      transition: transform .25s ease; padding-top: 60px; z-index: 1040;
    }
    .sidebar.show { transform: translateX(0); }
    @media (min-width: 992px){
      .sidebar { transform: none; padding-top: 0; }
      .content-wrap { margin-left: var(--sidebar-w); }
      .topbar .btn-toggle { display: none; }
    }
    .sidebar .brand {
      padding: 16px 18px; border-bottom: 1px solid var(--sidebar-border);
      font-weight: 700;
    }
    .sidebar .nav-link {
      color: var(--sidebar-link);
      padding: 10px 16px; border-radius: .5rem; margin: 4px 8px;
    }
    .sidebar .nav-link:hover { background: rgba(255,255,255,.05); color: #fff; }
    .sidebar .nav-link.active { background: var(--sidebar-link-active-bg); color: var(--sidebar-link-active); }
    .sidebar small.section {
      display: block; color: #8fa1bf; padding: 10px 18px 4px;
      margin-top: 8px; text-transform: uppercase; font-size: .73rem;
    }

    /* ===== KONTEN ===== */
    .card { background:#121a2b; border:1px solid #1f2b46; }
    .card-header { background:#0e1626; border-bottom:1px solid #1f2b46; color:#fff; }
    a { color:#9ec1ff; }
  </style>
</head>
<body>
  <!-- TOPBAR -->
  <div class="topbar">
    <div class="container-fluid py-2 d-flex align-items-center justify-content-between">
      <button class="btn btn-outline-light btn-sm btn-toggle" onclick="toggleSidebar()">☰</button>
      <div class="small text-muted">TPMS – Grafik & Hasil</div>
    </div>
  </div>

  <!-- SIDEBAR -->
  <nav id="sidebar" class="sidebar">
    <div class="brand">TPMS Dashboard</div>
    <small class="section">Navigasi</small>
    <ul class="nav flex-column mb-2">
      <li class="nav-item"><a class="nav-link" href="index.html">Beranda</a></li>
      <li class="nav-item"><a class="nav-link" href="membership.html">Membership Function</a></li>
      <li class="nav-item"><a class="nav-link" href="rules.html">Aturan (Rule Base)</a></li>
      <li class="nav-item"><a class="nav-link active" href="charts.html">Grafik & Hasil</a></li>
      <li class="nav-item"><a class="nav-link" href="realtime.html">Realtime</a></li>
      <li class="nav-item"><a class="nav-link" href="table.html">Tabel Data</a></li>
      <li class="nav-item"><a class="nav-link" href="about.html">Tentang</a></li>
    </ul>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="content-wrap">
    <div class="container py-4">
      <h1 class="h3 fw-bold mb-4">Grafik & Hasil Perhitungan</h1>
      <p class="text-secondary mb-4">Halaman ini menampilkan visualisasi hasil perhitungan logika fuzzy Sugeno dari sistem TPMS, meliputi grafik nilai sensor, hasil defuzzifikasi, dan status kondisi ban.</p>

      <!-- GRAFIK NILAI SENSOR -->
      <div class="card mb-4">
        <div class="card-header"><strong>1) Grafik Nilai Sensor dan Hasil Defuzzifikasi</strong></div>
        <div class="card-body">
          <canvas id="chartHasil" height="120"></canvas>
        </div>
      </div>

      <!-- GRAFIK STATUS -->
      <div class="card mb-4">
        <div class="card-header"><strong>2) Distribusi Status Kondisi Ban</strong></div>
        <div class="card-body">
          <canvas id="chartStatus" height="120"></canvas>
        </div>
      </div>

      <!-- TABEL RINGKASAN -->
      <div class="card mb-4">
        <div class="card-header"><strong>3) Ringkasan Hasil</strong></div>
        <div class="card-body">
          <table class="table table-sm table-bordered mb-0">
            <thead>
              <tr><th>Parameter</th><th>Nilai</th><th>Satuan</th></tr>
            </thead>
            <tbody>
              <tr><td>Tekanan</td><td id="tekananVal">23</td><td>psi</td></tr>
              <tr><td>Suhu</td><td id="suhuVal">28</td><td>°C</td></tr>
              <tr><td>Kecepatan</td><td id="speedVal">50</td><td>km/jam</td></tr>
              <tr><td>Nilai Fuzzy (Z)</td><td id="zVal">46</td><td>-</td></tr>
              <tr><td>Status</td><td id="statusVal" class="fw-bold text-warning">Waspada</td><td>-</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <footer class="text-center small text-secondary mt-4">© 2025 – TPMS Fuzzy Sugeno</footer>
    </div>
  </main>

  <!-- SCRIPT -->
  <script>
    function toggleSidebar(){
      document.getElementById('sidebar').classList.toggle('show');
    }

    // Data simulasi hasil sensor (bisa nanti dihubungkan ke ESP32)
    const tekanan = 23;
    const suhu = 28;
    const kecepatan = 50;
    const z = 46.25; // hasil defuzzifikasi contoh
    const status = (z >= 70) ? 'Bahaya' : (z >= 40 ? 'Waspada' : 'Aman');

    document.getElementById('tekananVal').textContent = tekanan;
    document.getElementById('suhuVal').textContent = suhu;
    document.getElementById('speedVal').textContent = kecepatan;
    document.getElementById('zVal').textContent = z.toFixed(0);
    document.getElementById('statusVal').textContent = status;
    document.getElementById('statusVal').classList.add(
      status === 'Aman' ? 'text-success' :
      status === 'Bahaya' ? 'text-danger' : 'text-warning'
    );

    // Grafik Nilai Sensor & Hasil Defuzzifikasi
    new Chart(document.getElementById('chartHasil'), {
      type: 'bar',
      data: {
        labels: ['Tekanan', 'Suhu', 'Kecepatan', 'Nilai Z'],
        datasets: [{
          label: 'Nilai (Crisp)',
          data: [tekanan, suhu, kecepatan, z],
          backgroundColor: [
            'rgb(0,200,255)',
            'rgb(0,255,157)',
            'rgb(255,213,79)',
            'rgb(255,99,132)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          x: { ticks:{color:'#e9edf3'}, grid:{color:'rgba(255,255,255,0.05)'} },
          y: { min:0, max:120, ticks:{color:'#e9edf3'}, grid:{color:'rgba(255,255,255,0.05)'} }
        },
        plugins: { legend:{labels:{color:'#e9edf3'}} }
      }
    });

    // Grafik Status Kondisi Ban
    new Chart(document.getElementById('chartStatus'), {
      type: 'doughnut',
      data: {
        labels: ['Aman', 'Waspada', 'Bahaya'],
        datasets: [{
          data: [status==='Aman'?1:0, status==='Waspada'?1:0, status==='Bahaya'?1:0],
          backgroundColor: ['rgb(0,255,157)', 'rgb(255,213,79)', 'rgb(255,99,132)'],
          borderColor: '#121a2b'
        }]
      },
      options: {
        plugins: {
          legend:{labels:{color:'#e9edf3'}},
          tooltip:{enabled:false}
        },
        cutout:'65%'
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
